<?xml version="1.0" encoding="UTF-8"?>
<project basedir=".">

    <target name="-init-clover-initstring" unless="clover.init.string">
        <property name="clover.init.string" location=".clover/clover.db"/>
    </target>

    <target name="-init-clover" depends="-init-clover-initstring">
        <path id="clover.classpath">
            <fileset dir="lib" includes="*clover*.jar"/>
            <fileset dir="${clover.search.path}" includes="*clover*.jar"/>
        </path>

        <taskdef resource="cloverlib.xml" classpathref="clover.classpath"/>
        <taskdef resource="cloverjunitlib.xml" classpathref="clover.classpath"/>

        <condition property="clover.installed">
            <and>
                <available classname="com.cenqua.clover.CloverInstr"/>
                <or>
                    <available file="lib/clover.license"/>
                    <available file="${clover.search.path}/clover.license"/>
                </or>
            </and>
        </condition>
    </target>

    <target name="with.clover" depends="-init-clover" if="clover.installed"
            description="Set up Clover to instrument tests.">
        <clover-env/>
        <clover-setup initstring="${clover.init.string}"/>
    </target>

    <target name="compile-for-tests" depends="clean,with.clover,jar"/>

</project>
